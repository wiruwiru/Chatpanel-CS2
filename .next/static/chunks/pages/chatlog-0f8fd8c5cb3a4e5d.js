(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[212],{2286:(e,a,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/chatlog",function(){return r(2566)}])},2566:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>N});var t=r(7876),s=r(4232),l=r(9099),n=r(369),o=r(4e3),d=r(3397),i=r(9081),c=r(7216),u=r(3707),m=r(1312),f=r(9516),g=r(7446),x=r(9983),h=r(7474),p=r(8434),b=r(7271),v=r(4846);function y(){let{toast:e}=(0,b.dj)(),a=(0,o.useRouter)(),r=(0,o.useSearchParams)(),l=r.get("page"),{t:n}=(0,v.Bd)(),[y,N]=(0,s.useState)([]),[j,w]=(0,s.useState)("all"),[S,k]=(0,s.useState)(""),[_,C]=(0,s.useState)("all"),[P,D]=(0,s.useState)(""),[E,R]=(0,s.useState)(l?Number.parseInt(l):1),[I,L]=(0,s.useState)(1),[M,U]=(0,s.useState)(!1),[O,B]=(0,s.useState)(!0),[T,z]=(0,s.useState)({}),[A,F]=(0,s.useState)(void 0),[K,$]=(0,s.useState)([]),q=[{value:"all",label:n("messageDisplay.filters.allChats")},{value:"0",label:n("messageDisplay.filters.globalMessage")},{value:"1",label:n("messageDisplay.filters.teamMessage")}],G=async()=>{try{let e=await fetch("/api/admin/config"),a=await e.json(),r=JSON.parse(a.SERVER_OPTIONS||"[]");$(r)}catch(a){console.error("Error fetching server options:",a),e({title:n("messageDisplay.error.title"),description:n("messageDisplay.error.fetchServerOptions"),variant:"destructive"})}},V=async a=>{try{let e=await fetch("/api/steam/profiles?ids=".concat(a.join(",")));if(!e.ok)throw Error("Failed to fetch Steam profiles");let r=await e.json();z(e=>({...e,...r}))}catch(a){console.error("Error fetching Steam profiles:",a),e({title:n("messageDisplay.error.title"),description:n("messageDisplay.error.fetchProfiles"),variant:"destructive"})}},Z=(0,s.useCallback)(async a=>{U(!0);try{let e=new URLSearchParams({page:a.toString(),..."all"!==j&&{serverId:j},...S&&{steamIdNameIpFilter:S},..."all"!==_&&{team:_},...P&&{message:P},...(null==A?void 0:A.from)&&{fromDate:A.from.toISOString()},...(null==A?void 0:A.to)&&{toDate:A.to.toISOString()}}),r=await fetch("/api/chatlogs/chatcstwo?".concat(e));if(!r.ok)throw Error("Failed to fetch messages");let t=await r.json();N(t.items),L(t.totalPages);let s=[...new Set(t.items.map(e=>e.playerSteam64))];s.length>0&&V(s)}catch(a){console.error("Error fetching messages:",a),e({title:n("messageDisplay.error.title"),description:n("messageDisplay.error.fetchMessages"),variant:"destructive"})}finally{U(!1)}},[j,S,_,P,A,n,e]);(0,s.useEffect)(()=>{G()},[]),(0,s.useEffect)(()=>{R(1),Z(1)},[j,S,_,P,A,Z]),(0,s.useEffect)(()=>{let e=r.get("page");e&&R(Number.parseInt(e)),Z(E)},[r,E,Z]);let W=e=>{switch(e.toString()){case"0":return"bg-red-500/80";case"1":return"bg-blue-500/80";default:return"bg-gray-500/80"}},H=e=>{switch(e.toString()){case"0":return n("messageDisplay.teamNames.global");case"1":return n("messageDisplay.teamNames.team");default:return n("messageDisplay.teamNames.unknown")}};return(0,t.jsxs)(i.Zp,{className:"max-w-6xl mx-auto bg-background shadow-lg border-border",children:[(0,t.jsxs)(i.aR,{className:"flex flex-row items-center justify-between border-b border-border",children:[(0,t.jsx)(i.ZB,{className:"text-foreground text-2xl font-bold",children:n("messageDisplay.title")}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(x.$,{onClick:()=>{Z(E)},variant:"outline",size:"icon",className:"bg-background text-foreground border-border hover:bg-accent hover:text-accent-foreground",children:(0,t.jsx)(m.A,{className:"h-4 w-4"})}),(0,t.jsx)("button",{onClick:()=>B(!O),className:"p-2 hover:bg-background rounded-full transition-colors",children:(0,t.jsx)(f.A,{className:"h-5 w-5 text-foreground"})})]})]}),(0,t.jsxs)(i.Wu,{className:"p-4",children:[O&&(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,t.jsxs)(u.l6,{value:j,onValueChange:w,children:[(0,t.jsx)(u.bq,{className:"bg-secondary text-foreground border-input",children:(0,t.jsx)(u.yv,{placeholder:n("messageDisplay.filters.selectServer")})}),(0,t.jsxs)(u.gC,{className:"bg-background border-border",children:[(0,t.jsx)(u.eb,{value:"all",className:"text-foreground",children:n("messageDisplay.filters.allServers")}),K.map(e=>(0,t.jsx)(u.eb,{value:e.value,className:"text-foreground",children:e.label},e.value))]})]}),(0,t.jsxs)(u.l6,{value:_,onValueChange:C,children:[(0,t.jsx)(u.bq,{className:"bg-secondary text-foreground border-input",children:(0,t.jsx)(u.yv,{placeholder:n("messageDisplay.filters.selectTeam")})}),(0,t.jsx)(u.gC,{className:"bg-background border-border",children:q.map(e=>(0,t.jsx)(u.eb,{value:e.value,className:"text-foreground",children:e.label},e.value))})]}),(0,t.jsx)(h.S,{value:A,onChange:e=>{F(e),R(1),Z(1)},className:"col-span-1"}),(0,t.jsx)(d.p,{placeholder:n("messageDisplay.filters.filterBySteamID"),value:S,onChange:e=>k(e.target.value),className:"bg-secondary text-foreground border-input col-span-1"}),(0,t.jsx)(d.p,{placeholder:n("messageDisplay.filters.filterByMessage"),value:P,onChange:e=>D(e.target.value),className:"bg-secondary text-foreground border-input col-span-2"})]}),(0,t.jsx)("div",{className:"space-y-4",children:M?(0,t.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,t.jsx)(g.A,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):y.map(e=>{var a,r,s;return(0,t.jsx)("div",{className:"flex justify-start w-full mb-4",children:(0,t.jsxs)("div",{className:"flex items-start space-x-3 w-full",children:[(0,t.jsx)(c.eu,{className:"h-10 w-10 border border-border shrink-0",children:(0,t.jsxs)("a",{href:"/chatlog/".concat(e.playerSteam64),target:"_blank",rel:"noopener noreferrer",children:[(0,t.jsx)(c.BK,{src:null===(a=T[e.playerSteam64])||void 0===a?void 0:a.avatarUrl,alt:e.playerName}),(0,t.jsx)(c.q5,{className:"bg-foreground text-muted-foreground",children:e.playerName.slice(0,2)})]})}),(0,t.jsxs)("div",{className:"flex flex-col items-start w-full",children:[(0,t.jsxs)("div",{className:"flex items-center w-full",children:[(0,t.jsx)("span",{className:"font-medium text-sm text-foreground",children:(0,t.jsx)("a",{href:"/chatlog/".concat(e.playerSteam64),target:"_blank",rel:"noopener noreferrer",children:(null===(r=T[e.playerSteam64])||void 0===r?void 0:r.displayName)||e.playerName})}),(0,t.jsxs)("div",{className:"ml-2 flex items-center space-x-2 text-xs text-muted-foreground",children:[(0,t.jsx)("span",{className:"px-2 py-0.5 rounded-full ".concat(W(e.team)," text-white"),children:H(e.team)}),(0,t.jsx)("span",{children:(null===(s=K.find(a=>a.value===e.serverId))||void 0===s?void 0:s.label)||"Unknown"})]})]}),(0,t.jsx)("div",{className:"mt-1 rounded-lg p-3 shadow-sm ".concat(W(e.team)," text-foreground w-full sm:w-auto max-w-full"),children:(0,t.jsx)("p",{className:"text-sm break-words",children:e.message})}),(0,t.jsxs)("div",{className:"mt-1 flex flex-wrap items-center gap-2 text-xs text-muted-foreground",children:[(0,t.jsx)("span",{children:e.created}),(0,t.jsxs)("span",{children:["IP: ",e.lastIP||"Unknown"]})]})]})]})},e.id)})}),(0,t.jsx)(p.T,{currentPage:E,totalPages:I,onPageChange:e=>{R(e),a.push("/chatlog?page=".concat(e),void 0,{shallow:!0}),window.scrollTo(0,0)},className:"mt-6"})]})]})}function N(){let[e,a]=(0,s.useState)(null),[r,o]=(0,s.useState)(!0),d=(0,l.useRouter)(),{t:i}=(0,v.Bd)();return((0,s.useEffect)(()=>{(async function(){try{let e=await fetch("/api/auth/session"),r=await e.json();r.user?a(r.user):d.push("/login")}catch(e){console.error("Error fetching user:",e),d.push("/login")}finally{o(!1)}})()},[d]),r)?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background",children:(0,t.jsx)("div",{className:"text-2xl font-semibold text-foreground",children:i("common.loading")})}):e?(0,t.jsxs)("div",{className:"min-h-screen bg-background text-foreground",children:[(0,t.jsx)(n.A,{}),(0,t.jsx)("div",{className:"p-8",children:(0,t.jsx)(y,{})})]}):null}},3397:(e,a,r)=>{"use strict";r.d(a,{p:()=>n});var t=r(7876),s=r(4232),l=r(8928);let n=s.forwardRef((e,a)=>{let{className:r,type:s,...n}=e;return(0,t.jsx)("input",{type:s,className:(0,l.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:a,...n})});n.displayName="Input"},5959:(e,a,r)=>{"use strict";r.d(a,{Eb:()=>m,Iu:()=>i,M_:()=>g,WA:()=>f,cU:()=>c,dK:()=>d,n$:()=>u});var t=r(7876),s=r(4232),l=r(8928),n=r(9983),o=r(5259);let d=e=>{let{className:a,...r}=e;return(0,t.jsx)("nav",{role:"navigation","aria-label":"pagination",className:(0,l.cn)("mx-auto flex w-full justify-center",a),...r})};d.displayName="Pagination";let i=s.forwardRef((e,a)=>{let{className:r,...s}=e;return(0,t.jsx)("ul",{ref:a,className:(0,l.cn)("flex flex-row items-center gap-1",r),...s})});i.displayName="PaginationContent";let c=s.forwardRef((e,a)=>{let{className:r,...s}=e;return(0,t.jsx)("li",{ref:a,className:(0,l.cn)("",r),...s})});c.displayName="PaginationItem";let u=e=>{let{className:a,isActive:r,size:s="icon",...o}=e;return(0,t.jsx)("a",{"aria-current":r?"page":void 0,className:(0,l.cn)((0,n.r)({variant:r?"outline":"ghost",size:s}),a),...o})};u.displayName="PaginationLink";let m=e=>{let{className:a,...r}=e;return(0,t.jsxs)(u,{"aria-label":"Go to previous page",size:"default",className:(0,l.cn)("gap-1 pl-2.5",a),...r,children:[(0,t.jsx)(o.YJP,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Previous"})]})};m.displayName="PaginationPrevious";let f=e=>{let{className:a,...r}=e;return(0,t.jsxs)(u,{"aria-label":"Go to next page",size:"default",className:(0,l.cn)("gap-1 pr-2.5",a),...r,children:[(0,t.jsx)("span",{children:"Next"}),(0,t.jsx)(o.vKP,{className:"h-4 w-4"})]})};f.displayName="PaginationNext";let g=e=>{let{className:a,...r}=e;return(0,t.jsxs)("span",{"aria-hidden":!0,className:(0,l.cn)("flex h-9 w-9 items-center justify-center",a),...r,children:[(0,t.jsx)(o.Oer,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"More pages"})]})};g.displayName="PaginationEllipsis"},7216:(e,a,r)=>{"use strict";r.d(a,{BK:()=>d,eu:()=>o,q5:()=>i});var t=r(7876),s=r(4232),l=r(8194),n=r(8928);let o=s.forwardRef((e,a)=>{let{className:r,...s}=e;return(0,t.jsx)(l.bL,{ref:a,className:(0,n.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",r),...s})});o.displayName=l.bL.displayName;let d=s.forwardRef((e,a)=>{let{className:r,...s}=e;return(0,t.jsx)(l._V,{ref:a,className:(0,n.cn)("aspect-square h-full w-full",r),...s})});d.displayName=l._V.displayName;let i=s.forwardRef((e,a)=>{let{className:r,...s}=e;return(0,t.jsx)(l.H4,{ref:a,className:(0,n.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",r),...s})});i.displayName=l.H4.displayName},7474:(e,a,r)=>{"use strict";r.d(a,{S:()=>p});var t=r(7876),s=r(4232),l=r(8283),n=r(3654),o=r(8928),d=r(9983),i=r(7550),c=r(5259);function u(e){let{className:a,classNames:r,showOutsideDays:s=!0,...l}=e;return(0,t.jsx)(i.hv,{showOutsideDays:s,className:(0,o.cn)("p-3",a),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,o.cn)((0,d.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-8 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:(0,o.cn)("relative p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected].day-range-end)]:rounded-r-md","range"===l.mode?"[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md":"[&:has([aria-selected])]:rounded-md"),day:(0,o.cn)((0,d.r)({variant:"ghost"}),"h-8 w-8 p-0 font-normal aria-selected:opacity-100"),day_range_start:"day-range-start",day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...r},components:{IconLeft:e=>{let{className:a,...r}=e;return(0,t.jsx)(c.YJP,{className:(0,o.cn)("h-4 w-4",a),...r})},IconRight:e=>{let{className:a,...r}=e;return(0,t.jsx)(c.vKP,{className:(0,o.cn)("h-4 w-4",a),...r})}},...l})}u.displayName="Calendar";var m=r(3178);let f=m.bL,g=m.l9;m.Mz;let x=s.forwardRef((e,a)=>{let{className:r,align:s="center",sideOffset:l=4,...n}=e;return(0,t.jsx)(m.ZL,{children:(0,t.jsx)(m.UC,{ref:a,align:s,sideOffset:l,className:(0,o.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",r),...n})})});x.displayName=m.UC.displayName;var h=r(4846);function p(e){let{className:a,value:r,onChange:s}=e,{t:i}=(0,h.Bd)();return(0,t.jsx)("div",{className:(0,o.cn)("grid gap-2",a),children:(0,t.jsxs)(f,{children:[(0,t.jsx)(g,{asChild:!0,children:(0,t.jsxs)(d.$,{id:"date",variant:"outline",className:(0,o.cn)("w-full justify-start text-left font-normal",!r&&"text-muted-foreground","bg-secondary text-foreground border-input hover:bg-background hover:text-accent-foreground"),children:[(0,t.jsx)(n.A,{className:"mr-2 h-4 w-4"}),(null==r?void 0:r.from)?r.to?(0,t.jsxs)(t.Fragment,{children:[(0,l.GP)(r.from,"LLL dd, y")," -"," ",(0,l.GP)(r.to,"LLL dd, y")]}):(0,l.GP)(r.from,"LLL dd, y"):(0,t.jsx)("span",{children:i("common.daterange")})]})}),(0,t.jsx)(x,{className:"w-auto p-0",align:"start",children:(0,t.jsx)(u,{initialFocus:!0,mode:"range",defaultMonth:null==r?void 0:r.from,selected:r,onSelect:s,numberOfMonths:2,className:"bg-background text-foreground border-border"})})]})})}},8434:(e,a,r)=>{"use strict";r.d(a,{T:()=>n});var t=r(7876),s=r(4232),l=r(5959);function n(e){let{currentPage:a,totalPages:r,onPageChange:n,className:o}=e,d=!function(e){let[a,r]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{let t=window.matchMedia(e);t.matches!==a&&r(t.matches);let s=()=>r(t.matches);return t.addEventListener("change",s),()=>t.removeEventListener("change",s)},[a,e]),a}("(max-width: 640px)")?5:3;return(0,t.jsx)(l.dK,{className:o,children:(0,t.jsxs)(l.Iu,{className:"gap-1",children:[(0,t.jsx)(l.cU,{children:(0,t.jsx)(l.Eb,{onClick:()=>n(Math.max(1,a-1)),className:"h-8 bg-background text-foreground border-border hover:bg-accent hover:text-accent-foreground",disabled:1===a})}),(()=>{let e=[],s=Math.max(1,a-Math.floor(d/2)),o=Math.min(r,s+d-1);o-s+1<d&&(s=Math.max(1,o-d+1)),s>1&&(e.push((0,t.jsx)(l.cU,{children:(0,t.jsx)(l.n$,{onClick:()=>n(1),className:"bg-background text-foreground border-border hover:bg-accent hover:text-accent-foreground",children:"1"})},"start")),s>2&&e.push((0,t.jsx)(l.cU,{children:(0,t.jsx)(l.M_,{className:"bg-background text-foreground border-border"})},"start-ellipsis")));for(let r=s;r<=o;r++)e.push((0,t.jsx)(l.cU,{children:(0,t.jsx)(l.n$,{onClick:()=>n(r),isActive:a===r,className:a===r?"bg-accent text-accent-foreground border-border":"bg-background text-foreground border-border hover:bg-accent hover:text-accent-foreground",children:r})},r));return o<r&&(o<r-1&&e.push((0,t.jsx)(l.cU,{children:(0,t.jsx)(l.M_,{className:"bg-background text-foreground border-border"})},"end-ellipsis")),e.push((0,t.jsx)(l.cU,{children:(0,t.jsx)(l.n$,{onClick:()=>n(r),className:"bg-background text-foreground border-border hover:bg-accent hover:text-accent-foreground",children:r})},"end"))),e})(),(0,t.jsx)(l.cU,{children:(0,t.jsx)(l.WA,{onClick:()=>n(Math.min(r,a+1)),className:"h-8 bg-background text-foreground border-border hover:bg-accent hover:text-accent-foreground",disabled:a===r})})]})})}},9081:(e,a,r)=>{"use strict";r.d(a,{BT:()=>i,Wu:()=>c,ZB:()=>d,Zp:()=>n,aR:()=>o});var t=r(7876),s=r(4232),l=r(8928);let n=s.forwardRef((e,a)=>{let{className:r,...s}=e;return(0,t.jsx)("div",{ref:a,className:(0,l.cn)("rounded-xl border bg-card text-card-foreground shadow",r),...s})});n.displayName="Card";let o=s.forwardRef((e,a)=>{let{className:r,...s}=e;return(0,t.jsx)("div",{ref:a,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",r),...s})});o.displayName="CardHeader";let d=s.forwardRef((e,a)=>{let{className:r,...s}=e;return(0,t.jsx)("div",{ref:a,className:(0,l.cn)("font-semibold leading-none tracking-tight",r),...s})});d.displayName="CardTitle";let i=s.forwardRef((e,a)=>{let{className:r,...s}=e;return(0,t.jsx)("div",{ref:a,className:(0,l.cn)("text-sm text-muted-foreground",r),...s})});i.displayName="CardDescription";let c=s.forwardRef((e,a)=>{let{className:r,...s}=e;return(0,t.jsx)("div",{ref:a,className:(0,l.cn)("p-6 pt-0",r),...s})});c.displayName="CardContent",s.forwardRef((e,a)=>{let{className:r,...s}=e;return(0,t.jsx)("div",{ref:a,className:(0,l.cn)("flex items-center p-6 pt-0",r),...s})}).displayName="CardFooter"}},e=>{var a=a=>e(e.s=a);e.O(0,[808,360,369,636,593,792],()=>a(2286)),_N_E=e.O()}]);